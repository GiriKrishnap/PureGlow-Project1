<%- include('../user/partials/header.ejs'); %>

    <section class="checkout_area section_gap mt-5 mb-5">
        <div class="container">
            <div class="billing_details">
                <form action="/placed-order" method="post" id="checkout-form">
                    <div class="row">
                        <div class="col-lg-8">
                            <h3>ADDRESS</h3>
                            <div class=" mt-2 text-end">
                                <a href="/add-address">
                                    <b class="text-light btn btn-primary mb-3">add-address</b>
                                </a>
                            </div>
                            <% if(typeof message !=='undefined' ){%>
                                <h5 class="text-danger"><b>
                                        <%= message %>.....!
                                    </b></h5>
                                <%} %>
                                    <!--user Address-->

                                    <!--ende userAddress-->
                                    <!--address table start here-->
                                    <% address.forEach(data=> { %>
                                        <div class="form-check pl-5 p-2 border border-secondary  mb-3 rounded">
                                            <input class="form-check-input" type="radio" name="flexRadioDefault"
                                                id="<%= data._id %>" value="<%= data._id %>" checked>
                                            <label class="form-check-label" for="flexRadioDefault1">
                                                <label for="" value="name">
                                                    <%= data.name %>
                                                </label><br>
                                                <label for="" value="mobile">
                                                    <%= data.phone %>
                                                </label><br>
                                                <label for="" value="email">
                                                    <%=data.email %>
                                                </label><br>
                                                <label for="" value="address">
                                                    <%= data.address %>
                                                </label><br>
                                                <label for="" value="state">
                                                    <%= data.state %>
                                                </label><br>
                                                <label for="" value="dist">
                                                    <%= data.district %>
                                                </label><br>
                                                <label for="" value="city">
                                                    <%= data.city %>
                                                </label><br>
                                                <label for="" value="landMark">
                                                    <%= data.landMark %>
                                                </label><br>
                                                <label for="" value="">
                                                    <%= data.pincode %>
                                                </label><br>
                                            </label>
                                            <div class="d-flex justify-content-end">
                                                <a href="/edit-address?id=<%= data._id %>"
                                                    class="btn btn-info m-2">edit</a>
                                                <a href="/delete-address?id=<%= data._id %>"
                                                    class="btn btn-danger m-2" onclick="return confirmAlert(event,'/delete-address?id=<%= data._id %>')">delete</a>
                                                </td>
                                            </div>
                                            </label>
                                        </div>

                                        <% }); %>
                                            <!--address table end here-->
                        </div>




                        <div class="col-lg-4">
                            <div class="order_box text-center col-lg-12 ">
                                <h2>Your Order</h2>
                                <div class="col-lg-12 ">
                                    <table class="mt-4 table table-striped ">
                                        <thead>
                                            <tr>
                                                <th class="col-lg-3">product</th>
                                                <th class="col-lg-3">price</th>
                                                <th class="col-lg-3">quantity</th>
                                                <th class="col-lg-3">Total</th>
                                            </tr>
                                        </thead>
                                        <% if(cartData){%>
                                            <% cartData.products.forEach(data=> { %>
                                                <tbody>
                                                    <tr>
                                                        <td>
                                                            <%= data.product_id.productName %>
                                                        </td>
                                                        <td>
                                                            <i class="bi bi-currency-rupee"></i><%= data.price %>
                                                        </td>
                                                        <td>
                                                            <%= data.quantity %>
                                                        </td>
                                                        <td>
                                                            <i class="bi bi-currency-rupee"></i><%= data.totalPrice %>
                                                        </td>

                                                    </tr>
                                                </tbody>
                                                <% }); %>
                                                    <%}else{%>

                                                        <%}%>
                                    </table>
                                </div>



                                <ul class="mt-3">
                                    <li><input type="text" placeholder="           Enter coupon code" id="getCoupon"
                                            name="CouponName" class="border border-white col-lg-12 mt-3"></li>
                                    <button class="mt-2 btn btn-info">Apply
                                        Coupon</button>
                                </ul>
                                <ul class="list list_2 mt-3">
                                    <hr>
                                    <li class="mt-4">Total Price <span id="gtd">
                                        <i class="bi bi-currency-rupee"></i><%= subTotalPrice %>
                                        </span></li>
                                    <hr>
                                    <!-- <li><a href="#">Total <span>$2210.00</span></a></li> -->
                                </ul>

                                <div class="payment_item">
                                    <div class="radion_btn">
                                        <input type="radio" id="f-option4" name="selector" value="wallet">
                                        <label for="f-option4">
                                            <div class="row">
                                                <div class="col-lg-10">wallet</div>
                                                <div class="col-lg-2"></div>
                                            </div>
                                        </label>
                                        <div class="check"></div>


                                    </div>

                                </div>
                                <div class="payment_item">
                                    <div class="radion_btn">
                                        <input type="radio" id="f-option5" name="selector" value="COD" checked>
                                        <label for="f-option5">Cash on delivery</label>
                                        <div class="check"></div>
                                    </div>
                                </div>
                                <div class="payment_item active item-center">
                                    <div class="radion_btn">
                                        <input type="radio" id="f-option6" name="selector" value="Razorpay">
                                        <label for="f-option6">Razor pay </label>
                                        <div class="check"></div>
                                    </div>
                                    <p>Pay via Razor Pay; you can pay with your upi transaction</p>
                                </div>

                                <input type="hidden" name="subTotalPrice" id="subTtle" value="">
                                <a href="/placed-order"><button type="submit"
                                        class="btn btn-primary col-lg-12">Submit</button></a>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </section>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/2.1.2/sweetalert.min.js"></script>
    <script>
        function confirmAlert(event,linkUrl) {
          // Prevent the default link behavior
          event.preventDefault();
      
          // Show the SweetAlert confirmation dialog
          swal({
            title: 'Are you sure?',
            text: 'Are you sure you want to visit this link?',
            icon: 'warning',
            buttons: ['Cancel', 'OK'],
          }).then((value) => {
            if (value) {
              // If the user clicks "OK," proceed with following the link
              window.location.href = linkUrl;
            }
          });
        }
      </script>

    <%- include('../user/partials/footer.ejs'); %>